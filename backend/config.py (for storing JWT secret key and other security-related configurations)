import os
from datetime import timedelta

# --- General Application Configuration ---
# This secret key can be used for various security purposes within the application,
# such as session management (if applicable) or other cryptographic operations.
# It should be a long, random string.
# For production, always set this via an environment variable.
SECRET_KEY = os.getenv("SECRET_KEY", "super-secret-default-key-please-change-in-production-12345")
if SECRET_KEY == "super-secret-default-key-please-change-in-production-12345":
    print("WARNING: SECRET_KEY is using a default value. Please set the SECRET_KEY environment variable in production.")

# --- JWT (JSON Web Token) Configuration ---
# The secret key used for signing JWTs. This is CRITICAL for security.
# It must be a strong, random string and kept absolutely secret.
# In production, this MUST be set via an environment variable.
JWT_SECRET_KEY = os.getenv("JWT_SECRET_KEY")
if not JWT_SECRET_KEY:
    # Raise an error if the critical JWT secret key is not set,
    # preventing the application from starting in an insecure state.
    raise ValueError("JWT_SECRET_KEY environment variable is not set. This is critical for security and must be configured.")

# The algorithm used to sign the JWTs. HS256 is a common and secure choice for symmetric keys.
JWT_ALGORITHM = os.getenv("JWT_ALGORITHM", "HS256")

# Access Token Expiration: How long an access token is valid.
# Shorter durations improve security by limiting the window of opportunity
# if a token is compromised, but require more frequent token refreshes.
# Value is in minutes.
ACCESS_TOKEN_EXPIRE_MINUTES = int(os.getenv("ACCESS_TOKEN_EXPIRE_MINUTES", 30))
ACCESS_TOKEN_EXPIRATION = timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)

# Refresh Token Expiration: How long a refresh token is valid.
# Refresh tokens are typically longer-lived and used to obtain new access tokens
# without requiring the user to re-authenticate with their credentials.
# A longer duration means users stay logged in longer without re-authenticating.
# Value is in days.
REFRESH_TOKEN_EXPIRE_DAYS = int(os.getenv("REFRESH_TOKEN_EXPIRE_DAYS", 7))
REFRESH_TOKEN_EXPIRATION = timedelta(days=REFRESH_TOKEN_EXPIRE_DAYS)

# Token Type: Standard prefix for JWTs in the Authorization header (e.g., "Bearer").
# This helps clients identify the type of token being sent.
TOKEN_TYPE = "Bearer"

# --- Other Security-Related Configurations (add as needed) ---
# Example: Password hashing algorithm and parameters (if using a library like bcrypt)
# BCRYPT_ROUNDS = int(os.getenv("BCRYPT_ROUNDS", 12))